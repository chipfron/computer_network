# 9.1 无线局域网WLAN
## 9.1.1 无线局域网的组成
- 无线局域网可分为两大类。第一类是**有固定基础设施的**，第二类是**无固定基础设施的**。
- **IEEE 802.11**
	1. 802.11标准规定无线局域网的最小构件是**基本服务集BSS**。一个基本服务集BSS包括一个基站和若干个移动站，所有的站在本BSS以内都可以直接通信，但在和本BSS以外的站通信时都必须通过本BSS的基站。
	2. 一个基本服务集可以是孤立的，也可通过接入点AP连接到一个**分配系统DS**，然后再连接到另一个基本服务集，这样就构成了一个**扩展的服务集** ESS。分配系统的作用就是使扩展的服务集ESS对上层的表现就像一个基本服务集BSS一样。分配系统可以使用以太网（这是最常用的）、点对点链路或其他无线网络。
	3. 若移动站使用**重建关联**服务，就可把这种关联转移到另一个接入点。当使用分离服务时，就可终止这种关联。
	4. 移动站与接入点AP建立关联的方法有两种。一种是被动扫描，即移动站等待接收接入点AP周期性发出的（例如每秒10次或100次）**信标帧**。信标帧中包含有若干系统参数（如服务集标识符SSID以及支持的速率等）。另一种是主动扫描，即移动站主动发出**探测请求帧**，然后等待从接入点发回的**探测响应帧**。
- **移动自组网络**
	1. 无固定基础设施的无线局域网，它又叫做**自组网络**。这种自组网络没有上述基本服务集中的接入点AP，而是由一些处于平等状态的移动站相互通信组成的临时网络。
	2. 自组网络通常是这样构成的：一些可移动的设备发现在它们附近还有其他的可移动设备，并且要求和其他移动设备进行通信。
	3. 无线传感器网络的应用就是进行各种数据的采集、处理和传输，一般并不需要很高的带宽，但是在大部分时间必须保持低功耗，以节省电池的消耗。由于无线传感结点的存储容量受限，因此对协议栈的大小有严格的限制。此外，无线传感器网络还对网络安全性、结点自动配置、网络动态重组等方面有一定的要求。
## 9.1.2 802.11局域网的物理层
- ![[Pasted image 20230815160504.png]]
## 9.1.3 802.11局域网的MAC层协议
- **CSMA/CA协议**
	1. “碰撞检测”（CD）在无线环境下不能使用，理由如下：
		- “碰撞检测”要求一个站点在发送本站数据的同时，还必须不间断地检测信道。一旦检测到碰撞，就立即停止发送。但由于无线信道的传输条件特殊，其信号强度的动态范围非常大，因此在802.11适配器上接收到的信号强度往往会远远小于发送信号的强度（信号强度可能相差百万倍）。如要在无线局域网的适配器上实现碰撞检测，在硬件上的花费就会过大。
		- 更重要的是，即使我们能够在硬件上实现无线局域网的碰撞检测功能，也仍然无法避免碰撞的发生。这就表明，无线局域网不需要进行碰撞检测。
	2. “无线局域网不需要进行碰撞检测”是由无线信道本身的特点决定的。我们知道，无线电波能够向所有的方向传播，且其传播距离受限。当电磁波在传播过程中遇到障碍物时，其传播距离就会受到限制。
	3. 无线局域网可能出现检测错误的情况：检测到信道空闲，其实信道并不空闲；有时检测到信道忙，其实信道并不忙。
	4. CSMA/CA协议，CA表示Collision Avoidance，是碰撞避免的意思，**协议的设计是要尽量减少碰撞发生的概率**。
	5. 802.11局域网在使用CSMA/CA的同时，还使用停止等待协议。这是因为无线信道的通信质量远不如有线信道的，因此无线站点每通过无线局域网发送完一帧后，要等到收到对方的确认帧后才能继续发送下一帧。这就是**链路层确认**。
	6. 802.11的MAC层在物理层的上面，它包括两个子层：
		- **分布协调功能DCF**。DCF不采用任何中心控制，而是在每一个结点使用CSMA机制的分布式接入算法，让各个站通过争用信道来获取发送权。因此DCF向上提供争用服务。802.11协议规定，所有的实现都**必须有** DCF功能。
		- **点协调功能PCF**。PCF是**选项**，是用接入点AP集中控制整个BSS内的活动，因此自组网络就没有PCF子层。PCF使用集中控制的接入算法，用类似于探询的方法把发送数据权轮流交给各个站，从而避免了碰撞的产生。对于时间敏感的业务，如分组话音，就应使用提供无争用服务的点协调功能PCF。
	7. 常用的两种帧间间隔的作用：
		- **SIFS**，即**短帧间间隔**，长度为28µs。SIFS是最短的帧间间隔，用来分隔开属于一次对话的各帧。在这段时间内，一个站应当能够从发送方式切换到接收方式。使用SIFS的帧类型有：ACK帧、CTS帧（在后面第2小节“对信道进行预约”中介绍）、由过长的MAC帧分片后的数据帧，以及所有回答AP探询的帧和在PCF方式中接入点AP发送出的任何帧。
		- **DIFS**，即**分布协调功能帧间间隔**，它比SIFS的帧间间隔要长得多，长度为128µs。在DCF方式中，DIFS用来发送数据帧和管理帧。
	8. **在信道从忙态转为空闲时，为了避免几个站同时发送数据（一旦发送就要把一帧发送完，不能中途停止），所有想发送数据的站就都要执行退避算法**。
	9. 可把CSMA/CA算法归纳如下：
		- 若站点**最初** 有数据要发送（而不是发送不成功再进行重传），且检测到信道空闲，在等待时间DIFS后，就发送整个数据帧。
		- 否则，站点执行CSMA/CA协议的退避算法。一旦检测到信道忙，就冻结退避计时器。只要信道空闲，退避计时器就进行倒计时。
		- 当退避计时器时间减少到零时（这时信道只可能是空闲的），站点就发送整个的帧并等待确认。发送站若收到确认，就知道已发送的帧被目的站正确收到了。这时如果要发送第二帧，就要从上面的第二个步骤开始，执行CSMA/CA协议的退避算法，随机选定一段退避时间。
	10. 以下几种情况必须使用退避算法：
		- 在发送第一个帧之前检测到信道处于忙态。
		- 每一次的重传。
		- 每一次的成功发送后再要发送下一帧。
- **对信道进行预约**
	1. A在向B发送数据帧之前，先发送一个短的控制帧，叫做**请求发送** RTS，它包括源地址、目的地址和这次通信（包括相应的确认帧）所需的持续时间。当然，A在发送RTS帧之前，必须先监听信道。若信道空闲，则等待一段时间DIFS后，才能够发送RTS帧。若B正确收到A发来的RTS帧，且媒体空闲，则等待一段时间SIFS后，就向A发送一个叫做**允许发送 CTS**的控制帧，它也包括这次通信所需的持续时间。A收到CTS帧后，再等待一段时间SIFS后，就可发送数据帧。若B正确收到了A发来的数据帧，在等待时间SIFS后，就向A发送确认帧ACK。
		- ![[Pasted image 20230815161415.png]]
	2. 使用RTS帧和CTS帧会使整个网络的通信效率有所下降。但由于这两种控制帧都很短，其长度分别为20字节和14字节，与数据帧（最长可达2346字节）相比开销不算大。相反，若不使用这种控制帧，则一旦发生碰撞而导致数据帧重发，浪费的时间就更多了。虽然如此，协议还是设有三种情况供用户选择。
		- 使用RTS帧和CTS帧。
		- 只有当数据帧的长度超过某一数值时才使用RTS帧和CTS帧（显然，当数据帧本身就很短时，再使用RTS帧和CTS帧只能增加开销）。
		- 不使用RTS帧和CTS帧。
## 9.1.4 802.11局域网的MAC帧
- 802.11帧共有三种类型，即**控制帧、数据帧**和**管理帧**。通过图9-10所示的802.11局域网的数据帧和三种控制帧的主要字段，可以进一步了解802.11局域网的MAC帧的特点。
	1. ![[Pasted image 20230815162650.png]]
- 从图9-10（a）可以看出，802.11数据帧由以下三大部分组成：
	1. MAC首部，共30字节。帧的复杂性都在帧的MAC首部。
	2. 帧主体，也就是帧的数据部分，不超过2312字节。这个数值比以太网的最大长度长很多。不过802.11帧的长度通常都小于1500字节。
	3. 帧检验序列FCS是MAC尾部，共4字节。
- **关于802.11数据帧的地址**
- **序号控制字段、持续期字段和帧控制字段**
	1. 介绍802.11数据帧中的其他一些字段：
		- **序号控制字段** 占16位，其中**序号子字段** 占12位（从0开始，每发送一个新帧就加1，到4095后再回到0），**分片子字段** 占4位（不分片则保持为0。如分片，则帧的序号子字段保持不变，而分片子字段从0开始，每个分片加1，最多到15）。重传的帧的序号和分片子字段的值都不变。序号控制的作用是使接收方能够区分开是新传送的帧还是因出现差错而重传的帧。这和运输层讨论的序号的概念是相似的。
		- 持续期字段** 占16位。在9.1.3节第2小节“对信道进行预约”中已经讲过CSMA/CA协议允许发送数据的站点预约信道一段时间（见前面的图9-8的例子），并把这个时间写入到持续期字段中。这个字段有多种用途（这里不对这些用途进行详细的说明），只有最高位为0时才表示持续期。这样，持续期不能超过2 15 –1＝32767，单位是微秒。
		- **帧控制字段** 共分为11个子字段。
			1. **类型字段**和**子类型字段**用来区分帧的功能。
			2. **更多分片字段** 置为1时表明这个帧属于一个帧的多个分片之一。
			3. **有线等效保密字段** WEP占1位。
# 9.2 无线个人区域网WPAN
- **无线个人区域网** WPAN就是在个人工作地方把属于个人使用的电子设备（如便携式电脑、平板电脑、便携式打印机以及蜂窝电话等）用无线技术连接起来自组网络，不需要使用接入点AP，整个网络的范围约为10m。
- **蓝牙系统**
- **低速WPAN**
	1. 在低速WPAN中最重要的就是ZigBee。ZigBee技术主要用于各种电子设备（固定的、便携的或移动的）之间的无线通信，其主要特点：
		- 通信距离短（10～80m），传输数据速率低，并且成本低廉。
		- ZigBee的另一个特点是功耗非常低。
		- ZigBee网络容量大。
- **高速WPAN**
# 9.3 无线城域网WMAN
- 
# 9.4 蜂窝移动通信网
## 9.4.1 蜂窝无线通信技术简介
## 9.4.2 移动IP
- 为了支持移动性，在网络层应当增加以下的一些新功能：
	1. **移动站到外地代理的协议** 。当移动站接入到被访网络时，必须向外地代理进行登记，以获得一个临时的转交地址。同样地，当移动站离开该被访网络时，它要向这个被访网络注销其原来的登记。
	2. **外地代理到归属代理的登记协议** 。外地代理要向移动站的归属代理登记移动站的转交地址。当移动站离开被访网络时，外地代理并不需要注销其在归属代理登记的转交地址。这是因为当移动站接入到另一个网络时，这个新的被访网络的外地代理就会到移动站的归属代理登记该移动站现在的转交地址，这样就取代了原来旧的转交地址。
	3. **归属代理数据报封装协议** 。归属代理收到发送给移动站的数据报后，将其再封装为一个新的数据报，其目的地址为移动站的转交地址，然后转发。
	4. **外地代理拆封协议** 。外地代理收到归属代理封装好的数据报后，取出原始数据报，并将此数据报发送给移动站。 
## 9.4.3 蜂窝移动通信网中对移动用户的路由选择
## 9.4.4 GSM中的切换
## 9.4.5 无线网络对高层协议的影响
# 9.5 两种不同的无线上网
# 本章的重要概念
- 无线局域网可分为两大类。第一类是有固定基础设施的，第二类是无固定基础设施的。
- 无线局域网的标准是IEEE的802.11系列。使用802.11系列协议的局域网又称为Wi-Fi。
- 802.11无线以太网标准使用星形拓扑，其中心叫做接入点AP，它就是基本服务集内的基站。
- 应当弄清几种不同的接入：固定接入、移动接入、便携接入和游牧接入。
- 802.11无线以太网在MAC层使用CSMA/CA协议。不能使用CSMA/CD的原因是：在无线局域网中，并非所有的站点都能够听见对方（例如，当有障碍物出现在站点之间时），因此无法实现碰撞检测。使用CSMA/CA协议是为了尽量减小碰撞发生的概率。
- 802.11无线局域网在使用CSMA/CA的同时，还使用停止等待协议。
- 802.11标准规定，所有的站在完成发送后，必须再等待一段帧间间隔时间才能发送下一帧。帧间间隔的长短取决于该站要发送的帧的优先级。
- 在802.11无线局域网的MAC帧首部中有一个**持续期** 字段，用来填入**在本帧结束后** 还要占用信道多少时间（以微秒为单位）。
- 802.11标准允许要发送数据的站对信道进行预约，即在发送数据帧之前先发送RTS帧请求发送。在收到响应允许发送的CTS帧后，就可发送数据帧。
- 802.11的MAC帧共有三种类型，即控制帧、数据帧和管理帧。需要注意的是，MAC帧有四个地址字段。在有固定基础设施的无线局域网中，只使用其中的三个地址字段，即源地址、目的地址和AP地址。
- 几种无线网络简介：无线个人区域网（蓝牙系统、ZigBee和超高速WPAN）。无线城域网WiMAX。
- 当计算机移动到外地时，移动IP技术允许该计算机仍然保留其原来的IP地址。移动IP使用了一些新概念，如永久地址、归属地址、归属网络、被访网络或外地网络、归属代理、外地代理、转交地址、同址转交地址等。
- 移动IP使用了几种协议，如移动站到外地代理的协议，外地代理到归属代理的登记协议，归属代理数据报封装协议，外地代理拆封协议等。
- 移动IP的路由选择有间接路由选择和直接路由选择，后者需要使用通信者代理和锚外地代理。
- 蜂窝移动通信网中对移动用户的路由选择需要弄清一些概念：归属位置寄存器HLR和来访用户位置寄存器VLR，移动站漫游号码MSRN，归属网络交换中心，归属MSC，锚MSC，被访网络的MSC。